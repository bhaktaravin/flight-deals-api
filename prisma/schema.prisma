generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Route {
  id          String   @id @default(uuid())
  origin      String
  destination String
  createdAt   DateTime @default(now())

  searches Search[]
}

model Search {
  id        String   @id @default(uuid())
  departAt  DateTime
  createdAt DateTime @default(now())

  route   Route  @relation(fields: [routeId], references: [id])
  routeId String
}

model FlightSearch {
  id          String         @id @default(uuid())
  origin      String
  destination String
  departDate  DateTime
  passengers  Int
  createdAt   DateTime       @default(now())
  results     FlightResult[]
}

model FlightResult {
  id              String @id @default(uuid())
  provider        String
  price           Int
  currency        String
  durationMinutes Int
  stops           Int

  searchId String
  search   FlightSearch @relation(fields: [searchId], references: [id])

  segments FlightSegment[]
}

model FlightSegment {
  id           String   @id @default(uuid())
  from         String
  to           String
  departAt     DateTime
  arriveAt     DateTime
  carrier      String
  flightNumber String

  resultId String
  result   FlightResult @relation(fields: [resultId], references: [id])
}
